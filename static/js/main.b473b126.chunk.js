(this.webpackJsonpidiom=this.webpackJsonpidiom||[]).push([[0],{24:function(e){e.exports=JSON.parse('{"COMMON":{"VERB":{"LOADING":"Loading"}},"TAGLINE":"The rogue-lite word game","START":{"BUTTON":"Start game","LANGUAGE":"Language"},"RESTART":{"BUTTON":"Launch a new game"},"GAME":{"INFO":{"HEALTH":"Health","SHIELD":"Shield","DIFFICULTY":"Difficulty","ROUND":"Round","KNOWN":"Known letters","ATTEMPTS":"Past attempts"},"BUTTON":{"ATTEMPT":"Attempt"}},"END":{"WIN":"You have won!","LOSS":"You have lost.","WORD":{"PRELUDE":"The word you were looking for was:","DEFINITION":"You can find the definition <tag>here</tag>."}}}')},25:function(e){e.exports=JSON.parse('{"COMMON":{"VERB":{"LOADING":"Chargement"}},"TAGLINE":"Le jeu de lettres rogue-lite","START":{"BUTTON":"Lancer une partie","LANGUAGE":"Langue"},"RESTART":{"BUTTON":"Lancer une nouvelle partie"},"GAME":{"INFO":{"HEALTH":"Vie","SHIELD":"Bouclier","DIFFICULTY":"Difficult\xe9","ROUND":"Round","KNOWN":"Lettres connues","ATTEMPTS":"Essais pr\xe9c\xe9dents"},"BUTTON":{"ATTEMPT":"Essayer"}},"END":{"WIN":"Vous avez gagn\xe9!","LOSS":"Vous avez perdu.","WORD":{"PRELUDE":"Le mot que vous cherchiez \xe9tait :","DEFINITION":"Vous pouvez trouver sa d\xe9finition <tag>ici</tag>."}}}')},38:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},65:function(e,t,n){},66:function(e,t,n){},67:function(e,t,n){},68:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(1),r=n.n(c),s=n(22),i=n.n(s),o=(n(38),n(39),n(40),n(10)),u=n(23),l=n(6),j=n(24),O=n(25);o.a.use(u.a).use(l.e).init({resources:{en:{translation:j},fr:{translation:O}},preload:["en","fr"],fallbackLng:"en",lng:"en",interpolation:{escapeValue:!1}});o.a;var d,b,h,f=n(5),g=n(77);n(41);function m(){var e=Object(g.a)().t;return Object(a.jsxs)("div",{className:"Title",children:[Object(a.jsx)("h1",{children:"Idiom"}),Object(a.jsx)("p",{children:e("TAGLINE")})]})}!function(e){e[e.Correct=0]="Correct",e[e.Misplaced=1]="Misplaced",e[e.Incorrect=2]="Incorrect",e[e.Default=3]="Default"}(d||(d={})),function(e){e[e.Ongoing=0]="Ongoing",e[e.Lost=1]="Lost",e[e.Won=2]="Won"}(b||(b={})),function(e){e.EN="en",e.FR="fr"}(h||(h={}));var v=n(9),x=n.n(v),A=n(13),p=n(2);function N(e){return E.apply(this,arguments)}function E(){return(E=Object(A.a)(x.a.mark((function e(t){var a,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next=e.t0===h.EN?3:e.t0===h.FR?7:11;break;case 3:return e.next=5,n.e(3).then(n.t.bind(null,79,3));case 5:return a=e.sent,e.abrupt("return",a.en);case 7:return e.next=9,n.e(4).then(n.t.bind(null,80,3));case 9:return c=e.sent,e.abrupt("return",c.fr);case 11:throw new Error("Unknown locale: "+t);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var w=Object(c.createContext)({state:{status:b.Ongoing,difficulty:0,round:0,armor:{max:0,value:0},health:{max:0,value:0},attempts:0,word:null},onRoundEnd:function(){},onFailedAttempt:function(){}});function T(e){var t=Object(g.a)().i18n,n=Object(c.useMemo)((function(){return t.languages[0]}),[t.languages]),r=Object(c.useState)({status:b.Ongoing,difficulty:3,round:0,armor:{max:5,value:5},health:{max:3,value:3},attempts:0,word:null}),s=Object(f.a)(r,2),i=s[0],o=s[1],u=Object(c.useCallback)((function(){o((function(e){return Object(p.a)(Object(p.a)({},e),{},{armor:Object(p.a)(Object(p.a)({},e.armor),{},{value:Math.max(0,e.armor.value-1)}),health:Object(p.a)(Object(p.a)({},e.health),{},{value:e.armor.value>0?e.health.value:Math.max(0,e.health.value-1)})})}))}),[o]),l=Object(c.useCallback)((function(e){o((function(t){return function(e,t){if(t!==b.Won)return Object(p.a)(Object(p.a)({},e),{},{status:b.Lost});var n=e.status,a=e.round,c=e.armor,r=e.difficulty;if(a++,c.value=c.max,5===a){var s=e.armor.max+1;c.value=s,c.max=s,r+=1,a=1}10===r&&(n=b.Won);return Object(p.a)(Object(p.a)({},e),{},{word:null,status:n,round:a,armor:c,difficulty:r})}(t,e)}))}),[]);return Object(c.useEffect)((function(){var e=!1;return Object(A.a)(x.a.mark((function t(){var a;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,L(i.difficulty,n);case 2:if(a=t.sent,!e){t.next=5;break}return t.abrupt("return");case 5:o((function(e){return Object(p.a)(Object(p.a)({},e),{},{word:a,attempts:e.armor.value+e.health.value})}));case 6:case"end":return t.stop()}}),t)})))(),function(){e=!0}}),[o,i.difficulty,i.round,n]),Object(a.jsx)(w.Provider,{value:{state:i,onFailedAttempt:u,onRoundEnd:l},children:e.children})}function I(){return Object(c.useContext)(w)}function L(e,t){return D.apply(this,arguments)}function D(){return(D=Object(A.a)(x.a.mark((function e(t,n){var a,c,r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N(n);case 2:return a=e.sent,c=a.filter((function(e){return e.length===t})),r=c[Math.floor(Math.random()*c.length)],e.abrupt("return",{original:r,ascii:r.normalize("NFD").replace(/[\u0300-\u036f]/g,"")});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var G=n(29),M=n(18),R=n.n(M);function C(e,t,n){return e.substr(0,t)+n+e.substr(t+n.length)}var B=n(30),F=n.n(B),k=n(31),S=n.n(k);n(65);function y(e){return Object(a.jsx)("div",{className:S()("Cell",{"Cell--correct":e.state===d.Correct,"Cell--misplaced":e.state===d.Misplaced}),children:Object(a.jsx)("div",{children:e.children})})}n(66);function U(e){var t=e.goalWord,n=e.attemptWord,r=e.showValidity,s=void 0===r||r,i=Object(c.useMemo)((function(){return F()(0,t.length)}),[t]),o=Object(c.useMemo)((function(){return n.split("")}),[n]),u=Object(c.useMemo)((function(){return s?function(e,t){for(var n=e,a=t,c=Array(e.length).fill(d.Incorrect),r=0;r<e.length;r++)t[r]===e[r]&&(n=C(n,r,"_"),a=C(a,r,"_"),c[r]=d.Correct);for(var s=0;s<e.length;s++)if("_"!==a[s]){var i=n.indexOf(a[s]);-1!==i&&(n=C(n,i,"_"),a=C(a,s,"_"),c[s]=d.Misplaced)}return c}(t,n):[]}),[s,t,n]);return Object(a.jsx)("div",{className:"Row",children:i.map((function(e){var t=o[e];return Object(a.jsx)("div",{className:"Row--cell",children:Object(a.jsx)(y,{state:s?u[e]:d.Default,children:t})},t+e)}))})}n(67);function W(e){var t=e.length,n=e.onAttempt,r=e.inputRef,s=Object(g.a)().t,i=Object(c.useState)(""),o=Object(f.a)(i,2),u=o[0],l=o[1],j=Object(c.useCallback)((function(){u.length===t&&(n(u),l(""))}),[t,n,u,l]),O=Object(c.useCallback)((function(e){l(e.target.value)}),[]),d=Object(c.useCallback)((function(e){"Enter"===e.key&&j()}),[j]);return Object(a.jsxs)("div",{className:"Input",children:[Object(a.jsxs)("div",{className:"Input--wrapper",children:[Object(a.jsx)(U,{goalWord:"_".repeat(t),attemptWord:u.padEnd(t," "),showValidity:!1}),Object(a.jsx)("input",{type:"text",value:u,onChange:O,onKeyDown:d,maxLength:t,ref:r})]}),Object(a.jsx)("button",{onClick:j,children:s("GAME.BUTTON.ATTEMPT")})]})}n(68);function H(e){var t=e.word,n=e.initialAttempts,r=e.onEnd,s=e.onFailedAttempt,i=Object(g.a)().t,o=Object(c.useRef)(null),u=Object(c.useMemo)((function(){return t.length}),[t]),l=Object(c.useState)([]),j=Object(f.a)(l,2),O=j[0],d=j[1],h=Object(c.useState)(n),m=Object(f.a)(h,2),v=m[0],x=m[1],A=Object(c.useCallback)((function(e){e.length===u&&(d((function(t){var n=t.concat();return n.push(e),n})),x((function(e){return e-1})))}),[d,u]),p=Object(c.useMemo)((function(){return R()(O)===t?b.Won:v>0?b.Ongoing:b.Lost}),[v,O,t]);Object(c.useEffect)((function(){p!==b.Ongoing&&r(p)}),[p,r]),Object(c.useEffect)((function(){O.length&&R()(O)!==t&&s()}),[O,t,s]),Object(c.useEffect)((function(){var e;null===(e=o.current)||void 0===e||e.focus()}),[]);var N=Object(c.useMemo)((function(){var e,n=t[0]+" ".repeat(t.length-1),a=Object(G.a)(O);try{for(a.s();!(e=a.n()).done;)for(var c=e.value,r=1;r<t.length;r++){var s=c[r];t[r]===s&&(n=C(n,r,s))}}catch(i){a.e(i)}finally{a.f()}return n}),[t,O]);return Object(a.jsxs)("div",{className:"Round",children:[p===b.Ongoing&&Object(a.jsx)("div",{className:"Round--input",children:Object(a.jsx)(W,{length:u,onAttempt:A,inputRef:o})}),Object(a.jsxs)("div",{className:"Round--grid",children:[p===b.Ongoing&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("h2",{children:i("GAME.INFO.KNOWN")}),Object(a.jsx)(z,{attemptWord:N,goalWord:t},t+"known")]}),!!O.length&&Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("h2",{children:i("GAME.INFO.ATTEMPTS")}),O.map((function(e,n){return Object(a.jsx)(z,{attemptWord:e,goalWord:t},t+e+n)}))]})]})]})}function z(e){return Object(a.jsx)("div",{className:"Round--row",children:Object(a.jsx)(U,Object(p.a)({},e))})}function J(){var e=Object(g.a)().t,t=I(),n=t.state,c=t.onRoundEnd,r=t.onFailedAttempt;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("div",{className:"Game--stats",children:[Object(a.jsxs)("div",{children:[Object(a.jsxs)("div",{className:"Game--valign",children:[Object(a.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAi0lEQVR42mNgGGzgPxomJI6q+W215f9f/4HgqwOYDdMAE/u/wwtZHLvmK3I2YDybzw4sBtKILIbLELjm/1W1EBuBdAqDD1gTTBzZEJwGwDTDNKBjkKFYDYA5FZ9mggbAnIsNwwzGZQBeQ2Dhgk8ziiEghegGEKMZpyGkaMYwhBzNKIaQqxk9D9AOAAABJBz7/dMlXgAAAABJRU5ErkJggg==",alt:e("GAME.INFO.HEALTH")}),Object(a.jsx)("div",{children:e("GAME.INFO.HEALTH")})]}),Object(a.jsxs)("div",{className:"Game--valign",children:[Object(a.jsx)("span",{className:"Game--stat",children:n.health.value}),Object(a.jsxs)("span",{children:["/ ",n.health.max]})]})]}),Object(a.jsxs)("div",{children:[Object(a.jsxs)("div",{className:"Game--valign",children:[Object(a.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAl0lEQVR42mNgoCL4D8Vkq/v//6vDfzwKwOJvqy3xGwDDSAbBNcIwTgN+/f//36P7yv+K6//BhoD4/3d4gTWJuEwEY4IGgDTDaJBhMI0wNtEGIBsCw0QZAFIIMwDGJ9oAkL9hYYDLAFCYEGUADMM0g9hgAxAxRLwBMBcRMgCnIcRqxjAEORrx+R2nIcgJiRTN6JmGLM1EAwD5HEWLBn3NqQAAAABJRU5ErkJggg==",alt:e("GAME.INFO.SHIELD")}),Object(a.jsx)("div",{children:e("GAME.INFO.SHIELD")})]}),Object(a.jsxs)("div",{className:"Game--valign",children:[Object(a.jsx)("span",{className:"Game--stat",children:n.armor.value}),Object(a.jsxs)("span",{children:["/ ",n.armor.max]})]})]})]}),Object(a.jsxs)("div",{className:"Game--stats Game--stats-mini",children:[Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{children:e("GAME.INFO.DIFFICULTY")}),Object(a.jsx)("div",{className:"Game--stat",children:n.difficulty})]}),Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{children:e("GAME.INFO.ROUND")}),Object(a.jsx)("div",{className:"Game--stat",children:n.round+1})]})]}),n.word?Object(a.jsx)(H,{word:n.word.ascii,initialAttempts:n.attempts,onEnd:c,onFailedAttempt:r},n.difficulty+"-"+n.round):Object(a.jsx)("p",{children:e("COMMON.VERB.LOADING")})]})}var V=n(78);function Y(){var e=Object(g.a)().t,t=Object(c.useContext)(q).launchNewGame,n=I().state.word,r=o.a.languages[0],s=Object(c.useMemo)((function(){return function(e,t){switch(t){case h.EN:return"https://en.wiktionary.org/wiki/".concat(e,"#English");case h.FR:return"https://fr.wiktionary.org/wiki/".concat(e,"#Fran%C3%A7ais");default:throw new Error("Unsupported locale")}}(n.original,r)}),[n,r]);return Object(a.jsxs)("div",{className:"GameLost",children:[Object(a.jsx)("h2",{children:e("END.LOSS")}),Object(a.jsx)("p",{children:e("END.WORD.PRELUDE")}),Object(a.jsx)("div",{className:"GameLost--word",children:n.original}),Object(a.jsx)("p",{children:Object(a.jsx)(V.a,{i18nKey:"END.WORD.DEFINITION",components:{tag:Object(a.jsx)("a",{href:s,target:"_blank",rel:"noopener noreferrer"})}})}),Object(a.jsx)("button",{onClick:t,children:e("RESTART.BUTTON")})]})}function K(){var e=Object(g.a)().t;return Object(a.jsx)("div",{className:"GameWon",children:e("END.WIN")})}n(74);function P(){var e=I().state.status;return Object(a.jsx)("div",{className:"Game",children:e===b.Ongoing?Object(a.jsx)(J,{}):e===b.Won?Object(a.jsx)(K,{}):Object(a.jsx)(Y,{})})}var q=Object(c.createContext)({launchNewGame:function(){}});function Q(){var e=Object(c.useState)(1),t=Object(f.a)(e,2),n=t[0],r=t[1],s=Object(c.useCallback)((function(){r((function(e){return e+1}))}),[r]);return Object(a.jsx)(q.Provider,{value:{launchNewGame:s},children:Object(a.jsx)(T,{children:Object(a.jsx)(P,{})},n.toString())})}n(75);function _(){var e=Object(g.a)(),t=e.t,n=e.i18n,r=Object(c.useState)(!1),s=Object(f.a)(r,2),i=s[0],u=s[1],l=Object(c.useCallback)((function(e){var t=e.target.value;n.changeLanguage(t)}),[n]);return Object(a.jsxs)("div",{className:"App",children:[Object(a.jsx)("div",{className:"App--title",children:Object(a.jsx)(m,{})}),i?Object(a.jsx)(Q,{}):Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("button",{onClick:function(){return u(!0)},children:t("START.BUTTON")}),Object(a.jsxs)("div",{className:"App--language",children:[Object(a.jsx)("span",{children:Object(a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",children:[Object(a.jsx)("path",{d:"M0 0h24v24H0z",fill:"none"}),Object(a.jsx)("path",{d:" M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z ",fill:"currentColor"})]})}),Object(a.jsx)("span",{children:t("START.LANGUAGE")}),Object(a.jsxs)("select",{value:o.a.languages[0],onChange:l,children:[Object(a.jsx)("option",{value:"en",children:"English"}),Object(a.jsx)("option",{value:"fr",children:"fran\xe7ais"})]})]})]})]})}i.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(_,{})}),document.getElementById("root"))}},[[76,1,2]]]);
//# sourceMappingURL=main.b473b126.chunk.js.map